{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst BASE_URL = 'https://pixabay.com/api';\nconst galleryContainer = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst fetchBtn = document.querySelector('.load-more');\n\nconst perPage = 40;\nconst totalHits = 500;\nlet currentPage = 1;\nlet searchQuery = '';\nconst totalImages = Math.ceil(totalHits / perPage);\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  document.querySelector('.form').addEventListener('submit', function (event) {\n    event.preventDefault();\n\n    loader.style.display = 'block';\n\n    const searchQuery = document.querySelector('.input').value;\n    currentPage = 1;\n    searchImages(searchQuery);\n  });\n});\n\nfetchBtn.addEventListener('click', async () => {\n  loader.style.display = 'block';\n  searchImages(searchQuery);\n  if (currentPage > totalImages) {\n    fetchBtn.style.display = 'none';\n    return iziToast.error({\n      title: 'Error',\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n  }\n});\n\nasync function searchImages(query) {\n  const searchParams = {\n    key: '41530173-f95b78bdec41263a85620f647',\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    per_page: perPage,\n    page: currentPage,\n  };\n\n  try {\n    const response = await axios.get(\n      `${BASE_URL}/?${new URLSearchParams(searchParams)}`\n    );\n\n    loader.style.display = 'none';\n    // loader.classList.remove('loader--active');\n\n    displayImages(response.data, perPage);\n  } catch (error) {\n    loader.style.display = 'none';\n    // loader.classList.remove('loader--active');\n\n    showErrorToast();\n  } finally {\n    loader.style.display = 'none';\n    loader.classList.remove('loader--active');\n  }\n\n  function displayImages(data, perPage) {\n    if (data.hits.length > 0) {\n      const imageCards = data.hits.map(image => {\n        const card = document.createElement('div');\n        card.classList.add('card');\n\n        const largeImageLink = document.createElement('a');\n        largeImageLink.href = image.largeImageURL;\n        largeImageLink.dataset.lightbox = 'gallery';\n        // largeImageLink.setAttribute('data-title', image.tags);\n\n        const img = document.createElement('img');\n        img.src = image.webformatURL;\n        img.alt = image.tags;\n\n        largeImageLink.appendChild(img);\n\n        card.appendChild(largeImageLink);\n\n        const details = document.createElement('div');\n        details.classList.add('details');\n\n        const likes = document.createElement('p');\n        likes.textContent = `Likes: ${image.likes}`;\n        details.appendChild(likes);\n\n        const views = document.createElement('p');\n        views.textContent = `Views: ${image.views}`;\n        details.appendChild(views);\n\n        const comments = document.createElement('p');\n        comments.textContent = `Comments: ${image.comments}`;\n        details.appendChild(comments);\n\n        const downloads = document.createElement('p');\n        downloads.textContent = `Downloads: ${image.downloads}`;\n        details.appendChild(downloads);\n\n        card.appendChild(details);\n\n        return card.outerHTML;\n      });\n\n      galleryContainer.insertAdjacentHTML('beforeend', imageCards.join(''));\n\n      const lightbox = new SimpleLightbox('.gallery a', {});\n      lightbox.refresh();\n\n      document.querySelector('.load-more').style.display = 'block';\n\n      if (\n        data.hits.length < perPage ||\n        currentPage * perPage >= data.totalHits\n      ) {\n        fetchBtn.style.display = 'none';\n      }\n      if (currentPage * perPage >= data.totalHits) {\n        iziToast.info({\n          title: 'End of Search Results',\n          message: \"We're sorry, but you've reached the end of search results.\",\n        });\n      }\n      currentPage += 1; // додаю сторінку при натисканні на кнопку\n    } else {\n      showNoImagesFoundToast();\n\n      fetchBtn.style.display = 'none';\n    }\n    // Отримання висоти однієї карточки галереї\n    const cardHeight = document\n      .querySelector('.card')\n      .getBoundingClientRect().height;\n\n    // Плавна прокрутка сторінки на дві висоти карточки галереї\n    window.scrollBy({\n      top: cardHeight * 2, // Прокрутити на дві висоти карточки\n      behavior: 'smooth', // Зробити прокрутку плавною\n    });\n  }\n}\n\nfunction showErrorToast() {\n  iziToast.error({\n    title: 'Error',\n    message: 'An error occurred. Please try again later.',\n  });\n}\n\nfunction showNoImagesFoundToast() {\n  iziToast.info({\n    title: 'No Images Found',\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n  });\n}\n"],"names":["BASE_URL","galleryContainer","loader","fetchBtn","perPage","totalHits","currentPage","searchQuery","totalImages","event","searchImages","iziToast","query","searchParams","response","axios","displayImages","showErrorToast","data","imageCards","image","card","largeImageLink","img","details","likes","views","comments","downloads","SimpleLightbox","showNoImagesFoundToast","cardHeight"],"mappings":"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"}