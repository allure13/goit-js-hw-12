{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst BASE_URL = 'https://pixabay.com/api';\nconst galleryContainer = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst fetchBtn = document.querySelector('.load-more');\n\nconst perPage = 40;\nlet currentPage = 1;\nlet searchQuery = '';\nlet totalHits = 0;\nlet totalPages = 0;\n\nlet clearImagesOnSearch = true;\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  document.querySelector('.form').addEventListener('submit', function (event) {\n    event.preventDefault();\n\n    loader.style.display = 'block';\n\n    // Оновлення значення searchQuery\n    const newSearchQuery = document.querySelector('.input').value;\n\n    // Перевірка, чи змінилася пошукова фраза\n    if (newSearchQuery !== searchQuery) {\n      currentPage = 1;\n      clearImagesOnSearch = true;\n      searchQuery = newSearchQuery;\n      searchImages(searchQuery);\n    }\n  });\n});\n\nfetchBtn.addEventListener('click', async () => {\n  loader.style.display = 'block';\n  clearImagesOnSearch = false;\n  searchImages(searchQuery);\n});\n\nasync function searchImages(query) {\n  const searchParams = {\n    key: '41530173-f95b78bdec41263a85620f647',\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    per_page: perPage,\n    page: currentPage,\n  };\n\n  try {\n    const response = await axios.get(\n      `${BASE_URL}/?${new URLSearchParams(searchParams)}`\n    );\n    totalHits = response.data.totalHits;\n    totalPages = Math.ceil(totalHits / perPage);\n    displayImages(response.data, perPage);\n  } catch (error) {\n    showErrorToast();\n  } finally {\n    loader.style.display = 'none';\n    loader.classList.remove('loader--active');\n  }\n\n  function displayImages(data) {\n    if (data.hits.length > 0) {\n      if (clearImagesOnSearch) {\n        galleryContainer.innerHTML = '';\n      }\n\n      const imageCards = data.hits.map(image => {\n        const card = document.createElement('div');\n        card.classList.add('card');\n\n        const largeImageLink = document.createElement('a');\n        largeImageLink.href = image.largeImageURL;\n        largeImageLink.dataset.lightbox = 'gallery';\n\n        const img = document.createElement('img');\n        img.src = image.webformatURL;\n        img.alt = image.tags;\n\n        largeImageLink.appendChild(img);\n\n        card.appendChild(largeImageLink);\n\n        const details = document.createElement('div');\n        details.classList.add('details');\n\n        const likes = document.createElement('p');\n        likes.textContent = `Likes: ${image.likes}`;\n        details.appendChild(likes);\n\n        const views = document.createElement('p');\n        views.textContent = `Views: ${image.views}`;\n        details.appendChild(views);\n\n        const comments = document.createElement('p');\n        comments.textContent = `Comments: ${image.comments}`;\n        details.appendChild(comments);\n\n        const downloads = document.createElement('p');\n        downloads.textContent = `Downloads: ${image.downloads}`;\n        details.appendChild(downloads);\n\n        card.appendChild(details);\n\n        return card.outerHTML;\n      });\n\n      galleryContainer.insertAdjacentHTML('beforeend', imageCards.join(''));\n\n      const lightbox = new SimpleLightbox('.gallery a', {});\n      lightbox.refresh();\n\n      document.querySelector('.load-more').style.display =\n        currentPage < totalPages ? 'block' : 'none';\n\n      if (currentPage >= totalPages) {\n        showInfoToast();\n      }\n\n      currentPage += 1; // додаю сторінку при натисканні на кнопку\n    } else {\n      showNoImagesFoundToast();\n\n      fetchBtn.style.display = 'none';\n    }\n    // Отримання висоти однієї карточки галереї\n    const cardHeight = document\n      .querySelector('.card')\n      .getBoundingClientRect().height;\n\n    // Плавна прокрутка сторінки на дві висоти карточки галереї\n    window.scrollBy({\n      top: cardHeight * 2, // Прокрутити на дві висоти карточки\n      behavior: 'smooth', // Зробити прокрутку плавною\n    });\n  }\n}\n\nfunction showInfoToast() {\n  iziToast.info({\n    title: 'End of Search Results',\n    message: \"We're sorry, but you've reached the end of search results.\",\n    position: 'topRight',\n    messageSize: 14,\n  });\n}\n\nfunction showErrorToast() {\n  iziToast.error({\n    title: 'Error',\n    message: 'An error occurred. Please try again later.',\n    position: 'topRight',\n    messageSize: 14,\n  });\n}\n\nfunction showNoImagesFoundToast() {\n  iziToast.info({\n    title: 'No Images Found',\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n    position: 'topRight',\n    messageSize: 14,\n  });\n}\n"],"names":["BASE_URL","galleryContainer","loader","fetchBtn","perPage","currentPage","searchQuery","totalHits","totalPages","clearImagesOnSearch","event","newSearchQuery","searchImages","query","searchParams","response","axios","displayImages","showErrorToast","data","imageCards","image","card","largeImageLink","img","details","likes","views","comments","downloads","SimpleLightbox","showInfoToast","showNoImagesFoundToast","cardHeight","iziToast"],"mappings":"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"}